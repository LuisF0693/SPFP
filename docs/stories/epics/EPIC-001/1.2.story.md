# 1.2: Criar Sistema de Atas de Reunião

**Status:** Draft
**Sprint:** 3
**Points:** 13
**Epic:** EPIC-001

---

## User Story

**Como** planejador financeiro
**Quero** criar e personalizar atas de reunião para meus clientes
**Para que** eles tenham um registro profissional do que discutimos

---

## Description

Implementar sistema completo de criação de atas de reunião com formulário intuitivo, editor rich-text para tópicos, lista de materiais recomendados, preview formatado e salvamento como rascunho. Template padrão configurável com suporte a emojis.

---

## Acceptance Criteria

### AC-002.1: Botão "Nova Ata de Reunião"
- [ ] Botão visível no perfil do cliente
- [ ] Abre modal com formulário
- [ ] Foco automático no primeiro campo

### AC-002.2: Formulário Completo
- [ ] Campo: Cliente (pré-populado)
- [ ] Campo: Data da Reunião (date picker)
- [ ] Campo: Próxima Reunião (date + time picker)
- [ ] Validação: todos os campos obrigatórios
- [ ] Mensagens de erro claras

### AC-002.3: Editor Rich-Text
- [ ] Editor para Tópicos Discutidos
- [ ] Suporte a: bold, italic, lista, emojis
- [ ] +/- Botões para adicionar/remover tópicos
- [ ] Preview em tempo real

### AC-002.4: Lista de Materiais Recomendados
- [ ] Dropdown com materiais disponíveis (Finclass, etc)
- [ ] Adicionar múltiplos materiais
- [ ] Remover material
- [ ] Ordenar por drag & drop

### AC-002.5: Preview Formatado
- [ ] Botão "Preview"
- [ ] Mostra ata formatada como será enviada
- [ ] Editar e voltar ao editor
- [ ] Scroll suave entre seções

### AC-002.6: Salvar como Rascunho
- [ ] Botão "Salvar Rascunho"
- [ ] Persiste em localStorage (player-specific)
- [ ] Alertar se houver alterações não salvas
- [ ] Notificação de sucesso

### AC-002.7: Template Padrão
- [ ] Template pré-definido configurável
- [ ] Variáveis: {cliente}, {data}, {data_proxima}, {topicos}, {pendencias}, {materiais}
- [ ] Deve renderizar corretamente

---

## Scope

### IN (Incluído)
- Formulário de nova ata
- Editor rich-text para tópicos
- Lista de materiais
- Preview formatado
- Salvar como rascunho
- Template padrão

### OUT (Não Incluído)
- Integração Email (vem em US-104)
- Integração WhatsApp (vem em US-105)
- Histórico (vem em US-108)
- Templates customizáveis (vem em US-106)

---

## Technical Notes

### Implementation Approach

1. **Components**
   - `MeetingMinutesForm.tsx` (NEW) - formulário principal
   - `RichTextEditor.tsx` (NEW) - editor tópicos
   - `MaterialSelector.tsx` (NEW) - seleção de materiais
   - `MinutesPreview.tsx` (NEW) - preview formatado
   - `MeetingMinutesModal.tsx` (NEW) - wrapper modal

2. **Data Structure**
```typescript
interface MeetingMinutes {
  id: string;
  client_id: string;
  client_name: string;
  meeting_date: Date;
  next_meeting_date: Date;
  next_meeting_time: string;
  topics: string[];
  pending_items: string[];
  materials: string[];
  notes?: string;
  saved_at?: Date;
}
```

3. **Libraries**
   - react-hook-form (formulário)
   - slate ou react-quill (rich text)
   - react-datepicker (date picker)

4. **File Structure**
```
src/components/
├── crm/
│   ├── meetings/
│   │   ├── MeetingMinutesForm.tsx (NEW)
│   │   ├── RichTextEditor.tsx (NEW)
│   │   ├── MaterialSelector.tsx (NEW)
│   │   ├── MinutesPreview.tsx (NEW)
│   │   └── MeetingMinutesModal.tsx (NEW)
```

---

## Definition of Done

- [ ] Formulário completo funcional
- [ ] Editor rich-text com emojis
- [ ] Preview renderiza corretamente
- [ ] Salvamento em localStorage
- [ ] Validações funcionando
- [ ] Responsive (mobile/tablet/desktop)
- [ ] Testes unitários para componentes
- [ ] Sem console errors
- [ ] Commit e PR criado

---

## Dependencies

**Blocks:** US-104 (Email), US-105 (WhatsApp), US-108 (Histórico)

**Depends On:** US-101 (UI modernizada)

---

## Business Value

**Alto** - Core feature do CRM, solução para problema principal

---

## Risks

| Risk | Mitigation |
|------|-----------|
| Complexidade do rich-text | MVP simplificado: bold, italic, emoji |
| Performance do localStorage | Limitar a 50KB de rascunho |
| UX confusa | Design simples, 5 cliques máximo |

---

## File List

- [ ] src/components/crm/meetings/MeetingMinutesForm.tsx
- [ ] src/components/crm/meetings/RichTextEditor.tsx
- [ ] src/components/crm/meetings/MaterialSelector.tsx
- [ ] src/components/crm/meetings/MinutesPreview.tsx
- [ ] src/components/crm/meetings/MeetingMinutesModal.tsx

---

## Change Log

- **2026-02-17:** Story created (US-102)
- **Status:** Draft for validation

