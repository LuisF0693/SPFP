# 2.5: Dashboard Operacional com Kanban de Tarefas

**Status:** Ready
**Sprint:** 7
**Points:** 13
**Epic:** EPIC-002

---

## User Story

**Como** empresário
**Quero** gerenciar tarefas operacionais em um Kanban board
**Para que** eu organize e acompanhe o progresso de trabalhos da equipe

---

## Description

Implementar modal/drawer com dashboard operacional contendo Kanban board com 3 colunas (A Fazer, Em Progresso, Concluído), criação de novas tarefas, drag & drop entre colunas, filtro por prioridade, contador de tarefas por coluna, alertas visuais para datas de vencimento próximas.

---

## Acceptance Criteria

### AC-005.1: Modal/Drawer Abre ao Clicar em Operacional
- [ ] Clique no departamento Operacional abre modal (desktop) ou drawer (mobile)
- [ ] Modal tem botão X para fechar
- [ ] Pressionar ESC fecha o modal
- [ ] Clique fora do modal fecha (se overlay)

### AC-005.2: Kanban Board com 3 Colunas
- [ ] Coluna 1: "A Fazer" (branco/default)
- [ ] Coluna 2: "Em Progresso" (azul)
- [ ] Coluna 3: "Concluído" (verde)
- [ ] Colunas lado a lado no desktop
- [ ] Stack vertical em mobile

### AC-005.3: Criar Nova Tarefa
- [ ] Botão "+ Nova Tarefa" acima ou na coluna "A Fazer"
- [ ] Modal/form com campos:
  - [ ] Título (obrigatório)
  - [ ] Descrição (opcional)
  - [ ] Prioridade (dropdown: Alta, Média, Baixa)
  - [ ] Responsável (texto ou dropdown de agentes)
  - [ ] Data de Vencimento (date picker, opcional)
- [ ] Validação básica (título obrigatório)
- [ ] Tarefa nova aparece no topo da coluna "A Fazer"

### AC-005.4: Drag & Drop Entre Colunas
- [ ] Clicar/arrastar tarefa entre colunas
- [ ] Visual feedback durante drag (sombra, opacidade)
- [ ] Drop update status da tarefa
- [ ] Sem lag perceptível
- [ ] Suporta mobile (touch events)
- [ ] Usa biblioteca react-beautiful-dnd ou similar

### AC-005.5: Filtro por Prioridade
- [ ] Dropdown no topo: "Todas", "Alta", "Média", "Baixa"
- [ ] Ao selecionar, mostra apenas tarefas dessa prioridade
- [ ] Contadores atualizam conforme filtro
- [ ] "Todas" mostra tudo

### AC-005.6: Contador de Tarefas por Coluna
- [ ] Cada coluna mostra "A Fazer (4)", "Em Progresso (2)", "Concluído (8)"
- [ ] Número atualiza ao adicionar/remover/mover tarefa
- [ ] Contador reflete filtro atual

### AC-005.7: Data de Vencimento com Alerta Visual
- [ ] Tarefas mostram data de vencimento se preenchida
- [ ] Data vencida: ícone/cor vermelha
- [ ] Vencimento próximo (< 3 dias): ícone/cor amarela
- [ ] Vencimento futuro (>= 3 dias): cor cinza
- [ ] Card pode ter borda colorida ou canto marcado

---

## Scope

### IN (Incluído)
- Modal/drawer dashboard operacional
- Kanban board com 3 colunas (A Fazer, Em Progresso, Concluído)
- Criar nova tarefa (form com 5 campos)
- Drag & drop entre colunas
- Filtro por prioridade (Todas, Alta, Média, Baixa)
- Contador de tarefas por coluna
- Alerta visual para datas de vencimento
- Responsividade (modal desktop, stack mobile)

### OUT (Não Incluído)
- Integração real-time com Supabase (usar mock data)
- Atribuição automática de tarefas
- Notificações de vencimento
- Histórico/audit de mudanças
- Tags/labels adicionais
- Subtarefas
- Comentários em tarefas

---

## Technical Notes

### Implementation Approach

1. **Component Principal** (`src/components/corporate/OperationalDashboard.tsx`)
   - Gerencia estado (tarefas, filtro prioridade)
   - Renderiza Kanban

2. **Sub-componentes**
   - `KanbanBoard.tsx` (NEW) - container do kanban
   - `KanbanColumn.tsx` (NEW) - coluna individual
   - `TaskCard.tsx` (NEW) - card de tarefa
   - `TaskForm.tsx` (NEW) - form criar tarefa
   - `PriorityFilter.tsx` (NEW) - dropdown filtro

3. **Mock Data**
   - `src/data/mockOperational.ts` (NEW) com 20-50 tarefas

4. **Libraries**
   - react-beautiful-dnd ou react-dnd (drag & drop)
   - TailwindCSS (layout)
   - React Icons (ícones prioridade)
   - date-fns (manipulação de datas)

5. **File Structure**
```
src/components/
├── corporate/
│   ├── OperationalDashboard.tsx (NEW)
│   ├── KanbanBoard.tsx (NEW)
│   ├── KanbanColumn.tsx (NEW)
│   ├── TaskCard.tsx (NEW)
│   ├── TaskForm.tsx (NEW)
│   └── PriorityFilter.tsx (NEW)
└── data/
    └── mockOperational.ts (NEW)
```

6. **Data Model**
```typescript
interface OperationalTask {
  id: string;
  user_id: string;
  title: string;
  description?: string;
  status: 'todo' | 'in_progress' | 'done';
  priority: 'alta' | 'media' | 'baixa';
  assignee?: string;
  due_date?: string; // ISO date
  completed_at?: string; // ISO timestamp
  position: number; // para ordenação
  created_at: string;
  updated_at: string;
}
```

---

## Definition of Done

- [x] OperationalDashboard renderiza corretamente
- [x] Kanban com 3 colunas funcionais
- [x] Botão "+ Nova Tarefa" abre form
- [x] TaskForm com 5 campos, validação básica
- [x] Drag & drop funciona (desktop e mobile)
- [x] Filtro por prioridade funcional
- [x] Contadores atualizando corretamente
- [x] Datas de vencimento com cores corretas
- [x] Modal/drawer responsivo
- [x] Sem console errors
- [ ] Testes unitários para KanbanBoard, TaskCard, PriorityFilter
- [x] Lighthouse Performance > 80
- [x] Commit local

---

## Dependencies

**Blocks:** Nenhum (UI apenas, pode usar mock data)

**Depends On:** US-201 (CorporateHQ para abrir dashboard)

---

## Business Value

**Alto** - Centraliza gestão de tarefas operacionais com visualização clara de progresso

---

## Risks

| Risk | Mitigation |
|------|-----------|
| Drag & drop lento em mobile | Usar bibliotecas otimizadas, testes em device real |
| Muitas tarefas = lag | Virtualização de tarefas, limit items em coluna |
| Form complexo = UX confuso | Validação em tempo real, helper text, defaults |

---

## File List

- [x] src/components/corporate/dashboards/OperationalDashboard.tsx
- [x] src/components/corporate/dashboards/components/KanbanBoard.tsx (integrated in OperationalDashboard)
- [x] src/components/corporate/dashboards/components/KanbanColumn.tsx (integrated in OperationalDashboard)
- [x] src/components/corporate/dashboards/components/TaskCard.tsx (DraggableTaskCard in OperationalDashboard)
- [x] src/components/corporate/dashboards/components/TaskForm.tsx
- [x] src/components/corporate/dashboards/components/PriorityFilter.tsx
- [x] src/data/operationalData.ts

---

## Change Log

- **2026-02-17:** Story created (US-205) in YOLO batch
- **2026-02-17:** @po validation PASSED (10/10 checklist) - Status: Draft → Ready
  - All 10 validation points met
  - Dependencies correctly mapped (depends on US-201)
  - Ready for @dev implementation
- **2026-02-17:** @dev implementation COMPLETED
  - OperationalDashboard implemented with 3-column Kanban board
  - Drag & drop entre colunas (A Fazer, Em Progresso, Concluído)
  - TaskForm com 5 campos obrigatórios/opcionais
  - PriorityFilter com seleção (Todas, Alta, Média, Baixa)
  - Contador de tarefas por coluna com atualização dinâmica
  - Alertas visuais para datas de vencimento (vencido/próximo/futuro)
  - Detalhes da tarefa expandível ao clicar
  - Status: Ready → InProgress → InReview
