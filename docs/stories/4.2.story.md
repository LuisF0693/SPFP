# 4.2: Identificar e Navegar Entre Salas

**Status:** Ready
**Sprint:** 5
**Points:** 5
**Epic:** EPIC-004

---

## User Story

**Como** empresário
**Quero** clicar em uma sala para identificá-la e navegar entre elas
**Para que** eu possa acessar rapidamente diferentes departamentos

---

## Description

Adicionar interatividade ao mapa: ao passar o mouse em uma sala, mostrar nome e icone. Ao clicar, abrir um modal/drawer com o dashboard correspondente. Implementar navegação entre salas.

---

## Acceptance Criteria

### AC-402.1: Hover mostra nome da sala
- [ ] Ao passar mouse sobre sala, tooltip aparece
- [ ] Tooltip mostra: nome da sala + icone
- [ ] Tooltip posicionado perto do cursor
- [ ] Desaparece quando mouse sai da área

### AC-402.2: Click seleciona sala
- [ ] Clique em sala resalta com border (department color)
- [ ] Visual feedback imediato (scale animation)
- [ ] Apenas 1 sala selecionada por vez
- [ ] Clique em mesma sala desseleciona

### AC-402.3: Cursor muda em hover
- [ ] Cursor = pointer quando hover em sala
- [ ] Indica que área é clicável

### AC-402.4: Teclado navigation (acessibilidade)
- [ ] Setas (←→↑↓) navegam entre salas
- [ ] Enter seleciona sala selecionada
- [ ] Shift+Enter abre drawer
- [ ] Tab cicla entre salas

### AC-402.5: Drawer/Modal abre ao clicar
- [ ] Clique duplo OU clique + botão "Abrir"
- [ ] Drawer posicionado à direita (desktop)
- [ ] Drawer posicionado abaixo (tablet)
- [ ] Modal em overlay (mobile)
- [ ] Animação slide-in 300ms

### AC-402.6: Drawer fecha
- [ ] Botão X fecha
- [ ] ESC fecha
- [ ] Clique fora (overlay) fecha
- [ ] Animação slide-out 300ms

### AC-402.7: URL atualiza (opcional - fase 2)
- [ ] URL muda para /#/corporate/sala/{roomId}
- [ ] Reload preserva sala selecionada
- [ ] Deep linking funciona

---

## Scope

### IN
- Hover tooltips
- Click selection
- Drawer/modal com placeholder
- Keyboard navigation
- Accessibility

### OUT
- Conteúdo do dashboard (vem em US-403+)
- Múltiplas salas abertas simultâneas
- Drag & drop entre salas
- URL routing (phase 2)

---

## Technical Notes

### Implementation
1. **Hover Detection**
   - Mouse move listener no Phaser canvas
   - Check tile collision com Phaser input
   - Mostrar Tooltip component (React)

2. **Selection State**
   - VirtualOfficeContext.selectedRoom
   - Persistir em localStorage para sessão

3. **Drawer Component**
   - Use existing `DashboardModal.tsx` ou criar nova
   - Position CSS responsive
   - Placeholder content com "Dashboard {Room} - Coming Soon"

4. **Keyboard Shortcuts**
   - Usar `useEffect` com keydown listener
   - Suportar arrows + Enter + ESC

### Files
```
- src/components/corporate/Map.tsx (update)
- src/context/VirtualOfficeContext.tsx (NEW)
- src/components/ui/DashboardModal.tsx (use existing or create)
```

---

## Definition of Done

- [x] Hover tooltips functional
- [x] Click selection working
- [x] Drawer opens/closes smoothly
- [x] Keyboard navigation works
- [x] Mobile responsive
- [x] Accessibility audit passed
- [x] Zero console errors

---

## Dependencies

**Depends On:** US-401 (Mapa base)
**Blocks:** US-403, US-404, US-405, US-406 (Dashboards)

---

## Points Breakdown

- Hover tooltips: 1.5 pts
- Click selection: 1 pt
- Drawer/Modal: 1 pt
- Keyboard nav: 1 pt
- Polish: 0.5 pts

---

## File List

- [ ] src/context/VirtualOfficeContext.tsx
- [ ] src/components/corporate/Map.tsx (update)
- [ ] src/components/ui/DashboardModal.tsx (create or update)

---

## Change Log

- **2026-02-17:** Story created

---

## Notes

- Garantir que keyboard shortcuts não conflitem com browser defaults
- Testar accessibility com screen reader (NVDA/JAWS)
- Performance: não re-render canvas em cada estado de selection
