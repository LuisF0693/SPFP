
> spfp@0.0.0 test
> vitest --run --no-coverage


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90mD:/Projetos Antigravity/SPFP/SPFP[39m

 [31mâ¯[39m src/test/crmUtils.test.ts [2m([22m[2m29 tests[22m[2m | [22m[31m9 failed[39m[2m | [22m[33m1 skipped[39m[2m)[22m[32m 59[2mms[22m[39m
       [32mâœ“[39m should return 100 for recently updated client with no data[32m 3[2mms[22m[39m
       [32mâœ“[39m should apply -15 penalty for 8 days of inactivity[32m 1[2mms[22m[39m
       [32mâœ“[39m should apply -30 penalty for 16 days of inactivity[32m 0[2mms[22m[39m
       [32mâœ“[39m should apply -60 penalty for 31 days of inactivity[32m 0[2mms[22m[39m
       [32mâœ“[39m should not exceed 100[32m 0[2mms[22m[39m
       [32mâœ“[39m should not go below 0[32m 0[2mms[22m[39m
       [2m[90mâ†“[39m[22m should add +5 bonus for having accounts
[31m       [31mÃ—[31m should add +5 bonus for having 50+ transactions[39m[32m 20[2mms[22m[39m
       [32mâœ“[39m should not add bonus for less than 50 transactions[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should add +5 bonus for having goals[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should combine all bonuses[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should cap combined score at 100[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should apply inactivity penalty before bonuses[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should apply all penalties and bonuses together[39m[32m 8[2mms[22m[39m
       [32mâœ“[39m should handle empty content object[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle null content gracefully[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle non-array accounts field[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle non-array transactions field[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle non-array goals field[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle exactly 7 days of inactivity boundary[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should handle exactly 15 days of inactivity boundary[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle exactly 30 days of inactivity boundary[32m 0[2mms[22m[39m
       [32mâœ“[39m should return integer score[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle very old last_updated timestamp[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should handle multiple accounts (only 1 bonus)[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle exactly 50 transactions for bonus threshold[39m[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should handle thousands of transactions[39m[32m 5[2mms[22m[39m
       [32mâœ“[39m should produce reasonable scores for inactive clients[32m 0[2mms[22m[39m
       [32mâœ“[39m should produce high scores for active clients with data[32m 0[2mms[22m[39m
 [31mâ¯[39m src/test/budgetAndGoals.test.ts [2m([22m[2m44 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 89[2mms[22m[39m
       [32mâœ“[39m should calculate progress percentage correctly[32m 3[2mms[22m[39m
       [32mâœ“[39m should handle progress at 0%[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle progress at 100%[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle progress exceeding 100%[32m 2[2mms[22m[39m
       [32mâœ“[39m should calculate remaining amount needed[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle goal with no target (edge case)[32m 2[2mms[22m[39m
       [32mâœ“[39m should update goal progress when adding funds[32m 1[2mms[22m[39m
       [32mâœ“[39m should update goal when withdrawing funds[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle reaching goal target[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle surpassing goal target[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle multiple deposits[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify quarter milestones[32m 2[2mms[22m[39m
       [32mâœ“[39m should track which milestones are achieved[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify next milestone[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should calculate progress to next milestone[39m[32m 16[2mms[22m[39m
       [32mâœ“[39m should identify goals approaching deadline[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify overdue goals[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate required monthly savings[32m 0[2mms[22m[39m
       [32mâœ“[39m should flag urgent goals (deadline within 7 days)[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate total across all goals[32m 0[2mms[22m[39m
       [32mâœ“[39m should rank goals by priority (progress)[32m 0[2mms[22m[39m
       [32mâœ“[39m should filter goals by category[32m 1[2mms[22m[39m
       [32mâœ“[39m should identify completed goals[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate goal has required fields[32m 1[2mms[22m[39m
       [32mâœ“[39m should validate currentAmount does not exceed reasonable bounds[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate targetAmount is positive[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate deadline is valid date[32m 0[2mms[22m[39m
       [32mâœ“[39m should calculate budget usage for category[32m 0[2mms[22m[39m
       [32mâœ“[39m should identify over-budget categories[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate overspend amount[32m 10[2mms[22m[39m
       [32mâœ“[39m should calculate remaining budget[32m 0[2mms[22m[39m
       [32mâœ“[39m should sum total budget across categories[32m 1[2mms[22m[39m
       [32mâœ“[39m should sum total spending across categories[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate total remaining budget[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should identify budget status[39m[32m 14[2mms[22m[39m
       [32mâœ“[39m should alert when spending exceeds 80% of budget[32m 1[2mms[22m[39m
       [32mâœ“[39m should alert when spending exceeds budget[32m 1[2mms[22m[39m
       [32mâœ“[39m should calculate days until budget alert needed[32m 1[2mms[22m[39m
       [32mâœ“[39m should compare spending against budget[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should identify most spent category[39m[32m 9[2mms[22m[39m
[31m       [31mÃ—[31m should identify least spent category[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m should calculate average spending per category[32m 1[2mms[22m[39m
       [32mâœ“[39m should validate budget has required fields[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate budget amounts are positive[32m 0[2mms[22m[39m
[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mcaptureContext[2m > [22m[2mshould capture error context with all details
[22m[39m[ERROR RECOVERY] Test Action {
  context: {
    userId: [32m'user123'[39m,
    action: [32m'Test Action'[39m,
    timestamp: [33m1770163323909[39m,
    errorType: [32m'NETWORK'[39m,
    originalError: Error: Test error
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:21:21
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
        at new Promise (<anonymous>)
        at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
        at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
        at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
        at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m {
      code: [32m'ECONNREFUSED'[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: { action: [32m'test'[39m }
  },
  message: [32m'Test error'[39m,
  stack: [32m'Error: Test error\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:21:21\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:145:11\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:26\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1653:37\n'[39m +
    [32m'    at Traces.$ (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)\n'[39m +
    [32m'    at trace (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)\n'[39m +
    [32m'    at runTest (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1653:12)'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mcaptureContext[2m > [22m[2mshould detect error type correctly
[22m[39m[ERROR RECOVERY] Network test {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Network test'[39m,
    timestamp: [33m1770163323920[39m,
    errorType: [32m'NETWORK'[39m,
    originalError: Error: Network error: Failed to fetch
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:37:28
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
        at new Promise (<anonymous>)
        at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
        at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
        at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
        at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'Network error: Failed to fetch'[39m,
  stack: [32m'Error: Network error: Failed to fetch\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:37:28\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:145:11\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:26\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1653:37\n'[39m +
    [32m'    at Traces.$ (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)\n'[39m +
    [32m'    at trace (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)\n'[39m +
    [32m'    at runTest (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1653:12)'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mcaptureContext[2m > [22m[2mshould handle errors without metadata
[22m[39m[ERROR RECOVERY] Simple action {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Simple action'[39m,
    timestamp: [33m1770163323926[39m,
    errorType: [32m'UNKNOWN'[39m,
    originalError: Error: Simple error
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:44:21
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
        at new Promise (<anonymous>)
        at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
        at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
        at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
        at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'Simple error'[39m,
  stack: [32m'Error: Simple error\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:44:21\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:145:11\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:26\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1653:37\n'[39m +
    [32m'    at Traces.$ (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)\n'[39m +
    [32m'    at trace (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)\n'[39m +
    [32m'    at runTest (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1653:12)'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mlogError[2m > [22m[2mshould create error log with provided details
[22m[39m[HIGH] User friendly message {
  errorId: [32m'error_1770163323936_za5ocailb'[39m,
  context: {
    action: [32m'Test Action'[39m,
    timestamp: [33m1770163323936[39m,
    userId: [32m'user123'[39m
  },
  recovered: [33mfalse[39m
}

[90mstdout[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mrollbackState[2m > [22m[2mshould call onRollback with previous state
[22m[39m[STATE ROLLBACK] State restored successfully { data: [32m'original'[39m }

[90mstdout[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mrollbackState[2m > [22m[2mshould handle rollback without callback
[22m[39m[STATE ROLLBACK] State restored successfully { data: [32m'original'[39m }

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mrollbackState[2m > [22m[2mshould throw error if rollback fails
[22m[39m[STATE ROLLBACK] Failed to restore state Error: Rollback failed
    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:193:52
    at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
    at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould retry operation with exponential backoff
[22m[39m[ATTEMPT 1/3] Test operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}
[BACKOFF] Retrying Test operation in 1038ms... { attempt: [33m1[39m, nextDelay: [33m1038[39m }

 [32mâœ“[39m src/test/utils.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 84[2mms[22m[39m
 [32mâœ“[39m src/test/example.test.ts [2m([22m[2m20 tests[22m[2m)[22m[32m 295[2mms[22m[39m
 [32mâœ“[39m src/test/UIContext.test.tsx [2m([22m[2m9 tests[22m[2m)[22m[33m 522[2mms[22m[39m
 [32mâœ“[39m src/test/utilities.test.ts [2m([22m[2m31 tests[22m[2m)[22m[32m 215[2mms[22m[39m
[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould retry on network error and succeed
[22m[39m[ATTEMPT 1/3] API Operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Failed to fetch'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}
[BACKOFF] Retrying API Operation in 100ms... { attempt: [33m1[39m, nextDelay: [33m100[39m }

 [32mâœ“[39m src/test/financeContextLogic.test.ts [2m([22m[2m34 tests[22m[2m)[22m[32m 46[2mms[22m[39m
 [32mâœ“[39m src/test/softDelete.test.ts [2m([22m[2m29 tests[22m[2m)[22m[32m 35[2mms[22m[39m
 [32mâœ“[39m src/test/validationService.test.ts [2m([22m[2m44 tests[22m[2m)[22m[32m 33[2mms[22m[39m
 [32mâœ“[39m src/test/transactionService.test.ts [2m([22m[2m28 tests[22m[2m)[22m[32m 27[2mms[22m[39m
[90mstdout[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould retry on network error and succeed
[22m[39m[RETRY SUCCESS] API Operation succeeded on attempt 2/3 { totalTimeMs: [33m104[39m }

[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould fail after max retries exceeded
[22m[39m[ATTEMPT 1/2] API Operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}
[BACKOFF] Retrying API Operation in 100ms... { attempt: [33m1[39m, nextDelay: [33m100[39m }

 [31mâ¯[39m src/test/accountService.test.ts [2m([22m[2m35 tests[22m[2m | [22m[31m9 failed[39m[2m)[22m[32m 94[2mms[22m[39m
[31m       [31mÃ—[31m should calculate invoice value for current month[39m[32m 17[2mms[22m[39m
       [32mâœ“[39m should return 0 for card with no expenses[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should not include income transactions[39m[32m 2[2mms[22m[39m
[31m       [31mÃ—[31m should filter by current month and year[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should calculate usage percentage[32m 0[2mms[22m[39m
       [32mâœ“[39m should return 0 when limit is 0[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle 100% usage[32m 0[2mms[22m[39m
       [32mâœ“[39m should find next due card by date[32m 0[2mms[22m[39m
       [32mâœ“[39m should skip cards without due day[32m 0[2mms[22m[39m
       [32mâœ“[39m should return undefined if no cards have due day[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle next month when due date passed[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should calculate days until due date[39m[32m 1[2mms[22m[39m
       [32mâœ“[39m should return 0 for undefined due day[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should calculate for next month if due day passed[39m[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m should return recent card transactions[39m[32m 17[2mms[22m[39m
       [32mâœ“[39m should not include income transactions[32m 2[2mms[22m[39m
       [32mâœ“[39m should respect limit parameter[32m 1[2mms[22m[39m
       [32mâœ“[39m should return empty array for empty card list[32m 1[2mms[22m[39m
       [32mâœ“[39m should group expenses by category[32m 3[2mms[22m[39m
       [32mâœ“[39m should include category color and icon[32m 0[2mms[22m[39m
[31m       [31mÃ—[31m should not include income transactions[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should limit to top 3 categories[32m 1[2mms[22m[39m
       [32mâœ“[39m should return correct labels[32m 5[2mms[22m[39m
       [32mâœ“[39m should calculate card balance correctly[32m 1[2mms[22m[39m
       [32mâœ“[39m should handle 0 limit[32m 0[2mms[22m[39m
       [32mâœ“[39m should handle negative balance[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate valid account[32m 0[2mms[22m[39m
       [32mâœ“[39m should reject empty name[32m 0[2mms[22m[39m
       [32mâœ“[39m should validate credit card required fields[32m 1[2mms[22m[39m
       [32mâœ“[39m should validate due day range[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should calculate correct statistics[39m[32m 10[2mms[22m[39m
       [32mâœ“[39m should handle empty credit cards[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m should return display and days for valid card[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m should return default when card is undefined[32m 0[2mms[22m[39m
       [32mâœ“[39m should return default when due day is undefined[32m 0[2mms[22m[39m
 [31mâ¯[39m src/test/Skeleton.test.tsx [2m([22m[2m12 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 1023[2mms[22m[39m
     [32mâœ“[39m renders text skeleton by default[32m 65[2mms[22m[39m
     [32mâœ“[39m renders multiple skeleton items when count is provided[32m 56[2mms[22m[39m
     [32mâœ“[39m renders card variant with correct structure[32m 15[2mms[22m[39m
     [32mâœ“[39m renders avatar variant with rounded-full[32m 5[2mms[22m[39m
[31m     [31mÃ—[31m renders table-row variant with correct structure[39m[32m 32[2mms[22m[39m
     [32mâœ“[39m renders chart variant[32m 28[2mms[22m[39m
     [33m[2mâœ“[22m[39m respects custom width [33m 702[2mms[22m[39m
     [32mâœ“[39m respects custom height[32m 73[2mms[22m[39m
     [32mâœ“[39m applies custom className[32m 10[2mms[22m[39m
     [32mâœ“[39m renders button variant with correct height[32m 8[2mms[22m[39m
     [32mâœ“[39m has animate-pulse class for loading effect[32m 6[2mms[22m[39m
     [32mâœ“[39m renders with proper background color classes[32m 15[2mms[22m[39m
[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould fail after max retries exceeded
[22m[39m[ATTEMPT 2/2] API Operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

 [31mâ¯[39m src/test/ErrorBoundary.test.tsx [2m([22m[2m0 test[22m[2m)[22m
[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould not retry non-retryable errors (401 Unauthorized)
[22m[39m[ATTEMPT 1/3] API Operation failed {
  errorType: [32m'UNAUTHORIZED'[39m,
  isRetryable: [33mfalse[39m,
  message: [32m'Unauthorized'[39m,
  status: [33m401[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould not retry validation errors (400 Bad Request)
[22m[39m[ATTEMPT 1/3] API Operation failed {
  errorType: [32m'VALIDATION'[39m,
  isRetryable: [33mfalse[39m,
  message: [32m'Invalid input'[39m,
  status: [33m400[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould call onRetry callback
[22m[39m[ATTEMPT 1/3] API Operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}
[BACKOFF] Retrying API Operation in 105ms... { attempt: [33m1[39m, nextDelay: [33m105[39m }

[90mstdout[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould call onRetry callback
[22m[39m[RETRY SUCCESS] API Operation succeeded on attempt 2/3 { totalTimeMs: [33m122[39m }

[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould timeout when operation takes too long
[22m[39m[ATTEMPT 1/1] API Operation failed {
  errorType: [32m'TIMEOUT'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Operation timed out after 100ms'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mretryWithBackoff[2m > [22m[2mshould include operation name in error message
[22m[39m[ATTEMPT 1/1] Fetch User Data failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mintegration: sequential retry attempts[2m > [22m[2mshould attach detailed error context to final error
[22m[39m[ATTEMPT 1/2] Test Operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}
[BACKOFF] Retrying Test Operation in 100ms... { attempt: [33m1[39m, nextDelay: [33m100[39m }

[90mstdout[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould retry operation with exponential backoff
[22m[39m[RETRY SUCCESS] Test operation succeeded on attempt 2/3 { totalTimeMs: [33m1045[39m }

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould throw after max retries exceeded
[22m[39m[ATTEMPT 1/2] Test operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}
[BACKOFF] Retrying Test operation in 942ms... { attempt: [33m1[39m, nextDelay: [33m942[39m }

[90mstderr[2m | src/services/retryService.test.ts[2m > [22m[2mretryService[2m > [22m[2mintegration: sequential retry attempts[2m > [22m[2mshould attach detailed error context to final error
[22m[39m[ATTEMPT 2/2] Test Operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

 [32mâœ“[39m src/services/retryService.test.ts [2m([22m[2m31 tests[22m[2m | [22m[33m4 skipped[39m[2m)[22m[33m 628[2mms[22m[39m
[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould throw after max retries exceeded
[22m[39m[ATTEMPT 2/2] Test operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould throw after max retries exceeded
[22m[39m[ERROR RECOVERY] Test operation {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Test operation'[39m,
    timestamp: [33m1770163326014[39m,
    errorType: [32m'NETWORK'[39m,
    originalError: Error: Test operation failed after 2 attempts: Network error
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:205:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:233:7
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'NETWORK'[39m,
      isRetryable: [33mtrue[39m,
      originalError: Error: Network error
          at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:231:28
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
          at new Promise (<anonymous>)
          at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
          at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
          at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
          at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
      attempts: [33m2[39m,
      lastAttemptTime: [33m1770163326013[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'Test operation failed after 2 attempts: Network error'[39m,
  stack: [32m'Error: Test operation failed after 2 attempts: Network error\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:205:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:233:7\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould call onRetry callback during retries
[22m[39m[ATTEMPT 1/2] Test failed {
  errorType: [32m'UNKNOWN'[39m,
  isRetryable: [33mfalse[39m,
  message: [32m'Error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould call onRetry callback during retries
[22m[39m[ERROR RECOVERY] Test {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Test'[39m,
    timestamp: [33m1770163326018[39m,
    errorType: [32m'UNKNOWN'[39m,
    originalError: Error: [UNKNOWN] Error
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:250:7
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'UNKNOWN'[39m,
      isRetryable: [33mfalse[39m,
      originalError: Error: Error
          at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:246:32
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
          at new Promise (<anonymous>)
          at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
          at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
          at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
          at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
      attempts: [33m1[39m,
      lastAttemptTime: [33m1770163326018[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'[UNKNOWN] Error'[39m,
  stack: [32m'Error: [UNKNOWN] Error\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:250:7\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould capture error context on failure
[22m[39m[ATTEMPT 1/1] Test operation failed {
  errorType: [32m'UNKNOWN'[39m,
  isRetryable: [33mfalse[39m,
  message: [32m'Test error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould capture error context on failure
[22m[39m[ERROR RECOVERY] Test operation {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Test operation'[39m,
    timestamp: [33m1770163326021[39m,
    errorType: [32m'UNKNOWN'[39m,
    originalError: Error: [UNKNOWN] Test error
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:264:9
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'UNKNOWN'[39m,
      isRetryable: [33mfalse[39m,
      originalError: Error: Test error
          at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:261:28
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
          at new Promise (<anonymous>)
          at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
          at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
          at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
          at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
      attempts: [33m1[39m,
      lastAttemptTime: [33m1770163326021[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'[UNKNOWN] Test error'[39m,
  stack: [32m'Error: [UNKNOWN] Test error\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:264:9\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould perform state rollback on failure if configured
[22m[39m[ATTEMPT 1/1] Test failed {
  errorType: [32m'UNKNOWN'[39m,
  isRetryable: [33mfalse[39m,
  message: [32m'Error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould perform state rollback on failure if configured
[22m[39m[ERROR RECOVERY] Test {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Test'[39m,
    timestamp: [33m1770163326024[39m,
    errorType: [32m'UNKNOWN'[39m,
    originalError: Error: [UNKNOWN] Error
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:282:9
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'UNKNOWN'[39m,
      isRetryable: [33mfalse[39m,
      originalError: Error: Error
          at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:277:28
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
          at new Promise (<anonymous>)
          at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
          at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
          at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
          at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
      attempts: [33m1[39m,
      lastAttemptTime: [33m1770163326024[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'[UNKNOWN] Error'[39m,
  stack: [32m'Error: [UNKNOWN] Error\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:282:9\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}

[90mstdout[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould perform state rollback on failure if configured
[22m[39m[STATE ROLLBACK] State restored successfully { data: [32m'original'[39m }

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould include attempt count in error
[22m[39m[ATTEMPT 1/3] Test failed {
  errorType: [32m'UNKNOWN'[39m,
  isRetryable: [33mfalse[39m,
  message: [32m'Error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mhandleOperation[2m > [22m[2mshould include attempt count in error
[22m[39m[ERROR RECOVERY] Test {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Test'[39m,
    timestamp: [33m1770163326027[39m,
    errorType: [32m'UNKNOWN'[39m,
    originalError: Error: [UNKNOWN] Error
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:299:9
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'UNKNOWN'[39m,
      isRetryable: [33mfalse[39m,
      originalError: Error: Error
          at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:296:28
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
          at new Promise (<anonymous>)
          at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
          at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
          at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
          at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
      attempts: [33m1[39m,
      lastAttemptTime: [33m1770163326027[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'[UNKNOWN] Error'[39m,
  stack: [32m'Error: [UNKNOWN] Error\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:299:9\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2msafeExecute[2m > [22m[2mshould include action in context when provided
[22m[39m[ERROR RECOVERY] Test action {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Test action'[39m,
    timestamp: [33m1770163326030[39m,
    errorType: [32m'UNKNOWN'[39m,
    originalError: Error: Error
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:353:44
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
        at new Promise (<anonymous>)
        at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
        at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
        at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
        at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'Error'[39m,
  stack: [32m'Error: Error\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:353:44\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:145:11\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:26\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1243:20\n'[39m +
    [32m'    at new Promise (<anonymous>)\n'[39m +
    [32m'    at runWithTimeout (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1209:10)\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1653:37\n'[39m +
    [32m'    at Traces.$ (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)\n'[39m +
    [32m'    at trace (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)\n'[39m +
    [32m'    at runTest (file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:1653:12)'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mgetErrorLogs[2m > [22m[2mshould return all logged errors
[22m[39m[HIGH] Error 2 {
  errorId: [32m'error_1770163326037_t4dms335k'[39m,
  context: { action: [32m'Test'[39m, timestamp: [33m1770163326036[39m },
  recovered: [33mfalse[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mgetCriticalErrors[2m > [22m[2mshould return only critical and high severity errors
[22m[39m[HIGH] High error {
  errorId: [32m'error_1770163326042_neb30stkn'[39m,
  context: { action: [32m'Test'[39m, timestamp: [33m1770163326042[39m },
  recovered: [33mfalse[39m
}
[CRITICAL] Critical error {
  errorId: [32m'error_1770163326042_v2ckppvny'[39m,
  context: { action: [32m'Test'[39m, timestamp: [33m1770163326042[39m },
  recovered: [33mfalse[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mexportErrorLogs[2m > [22m[2mshould export error logs for monitoring
[22m[39m[HIGH] Error {
  errorId: [32m'error_1770163326046_9b9dtb0vj'[39m,
  context: {
    action: [32m'Test'[39m,
    timestamp: [33m1770163326046[39m,
    stateSnapshot: { data: [32m'sensitive'[39m }
  },
  recovered: [33mfalse[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mwithErrorRecovery[2m > [22m[2mshould handle failed operation with recovery
[22m[39m[ATTEMPT 1/2] Test operation failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}
[BACKOFF] Retrying Test operation in 923ms... { attempt: [33m1[39m, nextDelay: [33m923[39m }

[90mstdout[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mwithErrorRecovery[2m > [22m[2mshould handle failed operation with recovery
[22m[39m[RETRY SUCCESS] Test operation succeeded on attempt 2/2 { totalTimeMs: [33m924[39m }

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mwithErrorRecovery[2m > [22m[2mshould throw after retries exhausted
[22m[39m[ATTEMPT 1/1] Test operation failed {
  errorType: [32m'UNKNOWN'[39m,
  isRetryable: [33mfalse[39m,
  message: [32m'Persistent error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mwithErrorRecovery[2m > [22m[2mshould throw after retries exhausted
[22m[39m[ERROR RECOVERY] Test operation {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Test operation'[39m,
    timestamp: [33m1770163326977[39m,
    errorType: [32m'UNKNOWN'[39m,
    originalError: Error: [UNKNOWN] Persistent error
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:480:7
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'UNKNOWN'[39m,
      isRetryable: [33mfalse[39m,
      originalError: Error: Persistent error
          at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:478:28
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
          at new Promise (<anonymous>)
          at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
          at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
          at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
          at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
      attempts: [33m1[39m,
      lastAttemptTime: [33m1770163326977[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'[UNKNOWN] Persistent error'[39m,
  stack: [32m'Error: [UNKNOWN] Persistent error\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:480:7\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould handle transaction save failure with rollback
[22m[39m[ATTEMPT 1/2] Save transactions failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}
[BACKOFF] Retrying Save transactions in 987ms... { attempt: [33m1[39m, nextDelay: [33m987[39m }

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould handle transaction save failure with rollback
[22m[39m[ATTEMPT 2/2] Save transactions failed {
  errorType: [32m'NETWORK'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Network error'[39m,
  status: [90mundefined[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould handle transaction save failure with rollback
[22m[39m[ERROR RECOVERY] Save transactions {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Save transactions'[39m,
    timestamp: [33m1770163327973[39m,
    errorType: [32m'NETWORK'[39m,
    originalError: Error: Save transactions failed after 2 attempts: Network error
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:205:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:504:9
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'NETWORK'[39m,
      isRetryable: [33mtrue[39m,
      originalError: Error: Network error
          at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:501:52
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
          at new Promise (<anonymous>)
          at runWithTimeout [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
          at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
          at Traces.$ [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.CCmnQaNT.js:142:27[90m)[39m
          at trace [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
          at runTest [90m(file:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m,
      attempts: [33m2[39m,
      lastAttemptTime: [33m1770163327973[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'Save transactions failed after 2 attempts: Network error'[39m,
  stack: [32m'Error: Save transactions failed after 2 attempts: Network error\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:205:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:504:9\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}

[90mstdout[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould handle transaction save failure with rollback
[22m[39m[STATE ROLLBACK] State restored successfully { transactions: [ { id: [32m'1'[39m, value: [33m100[39m } ] }

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould handle API rate limiting with appropriate message
[22m[39m[ATTEMPT 1/1] API call failed {
  errorType: [32m'RATE_LIMIT'[39m,
  isRetryable: [33mtrue[39m,
  message: [32m'Rate limit'[39m,
  status: [33m429[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould handle API rate limiting with appropriate message
[22m[39m[ERROR RECOVERY] API call {
  context: {
    userId: [90mundefined[39m,
    action: [32m'API call'[39m,
    timestamp: [33m1770163327977[39m,
    errorType: [32m'RATE_LIMIT'[39m,
    originalError: Error: API call failed after 1 attempts: Rate limit
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:205:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:520:9
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'RATE_LIMIT'[39m,
      isRetryable: [33mtrue[39m,
      originalError: [36m[Object][39m,
      attempts: [33m1[39m,
      lastAttemptTime: [33m1770163327976[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'API call failed after 1 attempts: Rate limit'[39m,
  stack: [32m'Error: API call failed after 1 attempts: Rate limit\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:205:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:520:9\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould handle authentication failure without retry
[22m[39m[ATTEMPT 1/3] Auth request failed {
  errorType: [32m'UNAUTHORIZED'[39m,
  isRetryable: [33mfalse[39m,
  message: [32m'Unauthorized'[39m,
  status: [33m401[39m,
  code: [90mundefined[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould handle authentication failure without retry
[22m[39m[ERROR RECOVERY] Auth request {
  context: {
    userId: [90mundefined[39m,
    action: [32m'Auth request'[39m,
    timestamp: [33m1770163327979[39m,
    errorType: [32m'UNAUTHORIZED'[39m,
    originalError: Error: [UNAUTHORIZED] Unauthorized
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:532:9
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'UNAUTHORIZED'[39m,
      isRetryable: [33mfalse[39m,
      originalError: [36m[Object][39m,
      attempts: [33m1[39m,
      lastAttemptTime: [33m1770163327979[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m
  },
  message: [32m'[UNAUTHORIZED] Unauthorized'[39m,
  stack: [32m'Error: [UNAUTHORIZED] Unauthorized\n'[39m +
    [32m'    at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)\n'[39m +
    [32m'    at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)\n'[39m +
    [32m'    at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:532:9\n'[39m +
    [32m'    at file:///D:/Projetos%20Antigravity/SPFP/SPFP/node_modules/@vitest/runner/dist/index.js:915:20'[39m
}
[HIGH] Erro ao Auth request: Acesso negado. Por favor, faÃ§a login novamente. {
  errorId: [32m'error_1770163327980_i56bway83'[39m,
  context: {
    userId: [90mundefined[39m,
    action: [32m'Auth request'[39m,
    timestamp: [33m1770163327979[39m,
    errorType: [32m'UNAUTHORIZED'[39m,
    originalError: Error: [UNAUTHORIZED] Unauthorized
        at retryWithBackoff (D:/Projetos Antigravity/SPFP/SPFP/src/services/retryService.ts:190:40)
        at Object.handleOperation (D:/Projetos Antigravity/SPFP/SPFP/src/services/errorRecovery.ts:191:24)
        at D:/Projetos Antigravity/SPFP/SPFP/src/test/errorRecovery.test.ts:532:9
        at [90mfile:///D:/Projetos%20Antigravity/SPFP/SPFP/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20 {
      code: [32m'UNAUTHORIZED'[39m,
      isRetryable: [33mfalse[39m,
      originalError: [36m[Object][39m,
      attempts: [33m1[39m,
      lastAttemptTime: [33m1770163327979[39m
    },
    stateSnapshot: [90mundefined[39m,
    metadata: [90mundefined[39m,
    attempts: [33m1[39m
  },
  recovered: [33mfalse[39m
}

[90mstderr[2m | src/test/errorRecovery.test.ts[2m > [22m[2mErrorRecoveryService[2m > [22m[2mError recovery integration scenarios[2m > [22m[2mshould provide error tracking for monitoring dashboard
[22m[39m[HIGH] Network timeout {
  errorId: [32m'error_1770163327980_7bgd451pu'[39m,
  context: { action: [32m'API Call'[39m, timestamp: [33m1770163327980[39m, userId: [32m'user1'[39m },
  recovered: [33mfalse[39m
}

 [31mâ¯[39m src/test/errorRecovery.test.ts [2m([22m[2m44 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 4076[2mms[22m[39m
       [32mâœ“[39m should capture error context with all details[32m 12[2mms[22m[39m
       [32mâœ“[39m should detect error type correctly[32m 5[2mms[22m[39m
       [32mâœ“[39m should handle errors without metadata[32m 5[2mms[22m[39m
       [32mâœ“[39m should create error log with provided details[32m 25[2mms[22m[39m
       [32mâœ“[39m should add log to logs array[32m 8[2mms[22m[39m
       [32mâœ“[39m should maintain max 100 logs[32m 2[2mms[22m[39m
       [32mâœ“[39m should mark as recovered when specified[32m 1[2mms[22m[39m
       [32mâœ“[39m should return network error message in Portuguese[32m 1[2mms[22m[39m
       [32mâœ“[39m should return timeout message in Portuguese[32m 0[2mms[22m[39m
       [32mâœ“[39m should return rate limit message in Portuguese[32m 1[2mms[22m[39m
       [32mâœ“[39m should return not found message in Portuguese[32m 0[2mms[22m[39m
       [32mâœ“[39m should return unauthorized message in Portuguese[32m 1[2mms[22m[39m
       [32mâœ“[39m should return validation message in Portuguese[32m 0[2mms[22m[39m
       [32mâœ“[39m should prepend action to message when provided[32m 4[2mms[22m[39m
[31m       [31mÃ—[31m should handle unknown error gracefully[39m[32m 4[2mms[22m[39m
       [32mâœ“[39m should call onRollback with previous state[32m 6[2mms[22m[39m
       [32mâœ“[39m should handle rollback without callback[32m 3[2mms[22m[39m
       [32mâœ“[39m should throw error if rollback fails[32m 12[2mms[22m[39m
       [32mâœ“[39m should execute successful operation without retry[32m 4[2mms[22m[39m
       [33m[2mâœ“[22m[39m should retry operation with exponential backoff [33m 1048[2mms[22m[39m
       [33m[2mâœ“[22m[39m should throw after max retries exceeded [33m 959[2mms[22m[39m
[31m       [31mÃ—[31m should call onRetry callback during retries[39m[32m 3[2mms[22m[39m
       [32mâœ“[39m should capture error context on failure[32m 3[2mms[22m[39m
       [32mâœ“[39m should perform state rollback on failure if configured[32m 3[2mms[22m[39m
       [32mâœ“[39m should include attempt count in error[32m 2[2mms[22m[39m
       [32mâœ“[39m should execute function and return result on success[32m 1[2mms[22m[39m
       [32mâœ“[39m should return fallback value on error[32m 0[2mms[22m[39m
       [32mâœ“[39m should call fallback function when it is a function[32m 0[2mms[22m[39m
       [32mâœ“[39m should call onError callback on failure[32m 0[2mms[22m[39m
       [32mâœ“[39m should include action in context when provided[32m 2[2mms[22m[39m
       [32mâœ“[39m should return all logged errors[32m 5[2mms[22m[39m
       [32mâœ“[39m should return copy of logs array[32m 3[2mms[22m[39m
       [32mâœ“[39m should return only errors for specific user[32m 1[2mms[22m[39m
       [32mâœ“[39m should return only critical and high severity errors[32m 2[2mms[22m[39m
       [32mâœ“[39m should clear all error logs[32m 1[2mms[22m[39m
       [32mâœ“[39m should export error logs for monitoring[32m 2[2mms[22m[39m
       [32mâœ“[39m should handle successful async operation[32m 1[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle failed operation with recovery [33m 927[2mms[22m[39m
       [32mâœ“[39m should throw after retries exhausted[32m 2[2mms[22m[39m
       [32mâœ“[39m should support userId option[32m 0[2mms[22m[39m
       [33m[2mâœ“[22m[39m should handle transaction save failure with rollback [33m 997[2mms[22m[39m
       [32mâœ“[39m should handle API rate limiting with appropriate message[32m 3[2mms[22m[39m
       [32mâœ“[39m should handle authentication failure without retry[32m 2[2mms[22m[39m
       [32mâœ“[39m should provide error tracking for monitoring dashboard[32m 1[2mms[22m[39m
 [32mâœ“[39m src/test/transactionGrouping.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m src/test/transactionCalculations.test.ts [2m([22m[2m25 tests[22m[2m)[22m[32m 22[2mms[22m[39m
 [32mâœ“[39m src/test/dataValidation.test.ts [2m([22m[2m39 tests[22m[2m | [22m[33m3 skipped[39m[2m)[22m[32m 22[2mms[22m[39m
 [32mâœ“[39m src/test/financeContextSplit.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [2m[90mâ†“[39m[22m src/test/aiService.test.ts [2m([22m[2m2 tests[22m[2m | [22m[33m2 skipped[39m[2m)[22m
 [32mâœ“[39m src/test/integration.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 13[2mms[22m[39m
